<!--
  Copyright (c) 2020, salesforce.com, inc.
  All rights reserved.
  SPDX-License-Identifier: BSD-3-Clause
  For full license text, see the LICENSE file in the repo root or https://opensource.org/licenses/BSD-3-Clause
-->

<template>
  <div class="lookup-container">
    <div class="slds-form-element">
      <label class="slds-form-element__label" for="not-selected-combobox">
        {lookupLabel}
      </label>

      <div class="slds-form-element__control">
        <div class="slds-combobox_container">
          <div
            class={showOptionsClass}
            aria-expanded={ariaExpandedShowOptionsClass}
            aria-haspopup="listbox"
            role="combobox"
          >
            <div
              class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right"
              role="none"
            >
              <input
                id="not-selected-combobox"
                aria-activedescendant=""
                class={noSelectedOptionClass}
                aria-autocomplete="list"
                autocomplete="off"
                role="textbox"
                type="text"
                placeholder={label.Input_placeholder}
                value={searchTerm}
                oninput={handleInput}
                onfocus={handleOnFocus}
                onblur={handleOnBlur}
                onkeydown={handleKeyDown}
              />

              <div class="slds-input__icon-group slds-input__icon-group_right">
                <div role="status" class={searchSpinnerClass}>
                  <span class="slds-assistive-text">
                    {label.Search_spinner_alt_text}
                  </span>
                  <div class="slds-spinner__dot-a"></div>
                  <div class="slds-spinner__dot-b"></div>
                </div>

                <button class={clearButtonClass} onclick={handleClearInput}>
                  <svg class="slds-button__icon" aria-hidden="true">
                    <use
                      xlink:href="/_slds/icons/utility-sprite/svg/symbols.svg#close"
                    ></use>
                  </svg>
                  <span class="slds-assistive-text">{label.Clear_input}</span>
                </button>
              </div>
            </div>

            <div
              class="listbox slds-dropdown slds-dropdown_fluid slds-dropdown_length-with-icon-5"
              role="listbox"
            >
              <ul
                class="slds-listbox slds-listbox_vertical"
                role="presentation"
              >
                <template for:each={searchOptions} for:item="item">
                  <li
                    role="presentation"
                    class="slds-listbox__item"
                    key={item.value}
                  >
                    <c-lookup-option
                      id={item.value}
                      item={item}
                      data-option={item.value}
                      active-option={activeOption}
                      onoptionselect={handleOptionSelect}
                      onoptionactivate={handleOptionActivate}
                      search-term={searchTerm}
                    ></c-lookup-option>
                  </li>
                </template>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>
